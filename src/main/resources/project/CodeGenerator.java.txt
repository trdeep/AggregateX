
import cn.treedeep.king.generator.DDDModuleGenerator;
import cn.treedeep.king.generator.model.AggregateRoot;
import cn.treedeep.king.generator.model.Entity;
import cn.treedeep.king.generator.model.Module;
import cn.treedeep.king.generator.model.ValueObject;

import java.util.List;

/**
 * æµ‹è¯•å€¼å¯¹è±¡ç”Ÿæˆ
 */
public class ValueObjectGeneratorTest {

    public static void main(String[] args) {
        // å·¥ç¨‹ä¿¡æ¯
        String path = "/Users/zhougm/vscode/KingAdmin";
        String packageName = "cn.treedeep.king.admin";


        // å®šä¹‰å¸¦æœ‰å±æ€§çš„å€¼å¯¹è±¡
        var phoneValueObject = ValueObject.create("Phone", "æ‰‹æœº",
                Entity.property("phoneNumber", "æ‰‹æœºå·ç "),
                Entity.property("countryCode", "å›½å®¶ä»£ç "));

        // å®šä¹‰å¸¦æœ‰å±æ€§çš„å®ä½“
        var loginRecordEntity = Entity.create("LoginRecord", "ç™»å½•è®°å½•",
                Entity.property("loginTime", "ç™»å½•æ—¶é—´"),
                Entity.property("ipAddress", "ç™»å½•IPåœ°å€"),
                Entity.property("deviceInfo", "ç™»å½•è®¾å¤‡ä¿¡æ¯"),
                Entity.property("userId", "ç”¨æˆ·ID"));

        // å®šä¹‰æ¨¡å—ä¿¡æ¯
        var modules = List.of(
                Module.create("authentication", "è®¤è¯",
                        AggregateRoot.create("User", "ç”¨æˆ·èšåˆæ ¹",
                                Entity.create("Info", "ä¿¡æ¯å®ä½“",
                                        Entity.property("username", "ç”¨æˆ·å"),
                                        Entity.property("email", "é‚®ç®±")),
                                Entity.create("Role", "è§’è‰²å®ä½“"),
                                phoneValueObject,
                                loginRecordEntity
                        )
                )
        );

        try {
            DDDModuleGenerator generator = new DDDModuleGenerator();

            // æ‰¹é‡ç”Ÿæˆ
            generator.generateModules(path, packageName, modules, true);

            System.out.println("ğŸ‰ æ‰€æœ‰æ¨¡å—ç”ŸæˆæˆåŠŸ");

        } catch (Exception e) {
            System.err.println("âŒ æ¨¡å—ç”Ÿæˆå¤±è´¥: " + e.getMessage());
            e.printStackTrace();
        }
    }
}
